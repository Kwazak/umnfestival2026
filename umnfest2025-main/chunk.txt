paginatedTickets.map((ticket) => (
                                    <tr key={ticket.id} className="hover:bg-gray-50">
                                        <td className="px-6 py-4 whitespace-nowrap">
                                            <span className="font-mono text-sm font-medium text-gray-900">
                                                {showCode[ticket.id] ? ticket.ticket_code : 'â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢'}
                                            </span>
                                            <button
                                                onClick={() => setShowCode(prev => ({ ...prev, [ticket.id]: !prev[ticket.id] }))}
                                                className="ml-2 text-xs text-blue-500 underline focus:outline-none"
                                            >
                                                {showCode[ticket.id] ? 'Hide' : 'Show'}
                                            </button>
                                        </td>
                                        <td className="px-6 py-4 whitespace-nowrap">
                                            {getStatusBadge(ticket.status)}
                                        </td>
                                        <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                                            {ticket.order?.buyer_name || '-'}
                                        </td>
                                        <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                            {formatDate(ticket.checked_in_at)}
                                        </td>
                                        <td className="px-6 py-4 whitespace-nowrap text-sm">
                                            {ticket.scanned_by ? (
                                                <span className="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                                                    ðŸ‘¤ {ticket.scanned_by}
                                                </span>
                                            ) : (
                                                <span className="text-gray-400">-</span>
                                            )}
                                        </td>
                                        <td className="px-6 py-4 whitespace-nowrap text-sm">
                                            <button
                                                className={`px-3 py-1 rounded text-white text-xs font-semibold ${ticket.status === 'pending' ? 'bg-gray-400 cursor-not-allowed' : 'bg-amber-600 hover:bg-amber-700'}`}
                                                disabled={ticket.status === 'pending'}
                                                title="Reset ticket ini ke VALID dan kosongkan check-in"
                                                onClick={async () => {
                                                    if (ticket.status === 'pending') return;
                                                    // Step 1: show confirmation with ticket info
                                                    const confirm1 = confirm(`Yakin reset ticket ${ticket.ticket_code}?\n\nAksi ini akan mengubah status menjadi VALID dan mengosongkan waktu check-in.`);
                                                    if (!confirm1) return;
                                                    // Step 2: require exact typing of ticket code
                                                    const typed = prompt('Ketik ulang KODE TICKET untuk konfirmasi:');
                                                    if (typed === null) return;
                                                    if ((typed || '').trim().toUpperCase() !== (ticket.ticket_code || '').toUpperCase()) {
                                                        alert('Konfirmasi gagal: kode ticket tidak cocok.');
                                                        return;
                                                    }
                                                    // Step 3: require secret
                                                    const secret = prompt('Masukkan kode rahasia untuk melanjutkan:');
                                                    if (secret === null) return;
                                                    if (secret !== 'JANGANLAKUKANINIDIHARIH') {
                                                        alert('Kode rahasia salah. Aksi dibatalkan.');
                                                        return;
                                                    }

                                                    try {
                                                        const csrfToken = document.querySelector('meta[name="csrf-token"]')?.content;
                                                        const res = await fetch(`/api/tickets/${encodeURIComponent(ticket.ticket_code)}/reset`, {
                                                            method: 'POST',
                                                            headers: {
                                                                'Content-Type': 'application/json',
                                                                'Accept': 'application/json',
                                                                'X-Requested-With': 'XMLHttpRequest',
                                                                ...(csrfToken && { 'X-CSRF-TOKEN': csrfToken }),
                                                            },
                                                            credentials: 'same-origin',
                                                            body: JSON.stringify({ secret, confirm_code: ticket.ticket_code })
                                                        });
                                                        const data = await res.json().catch(() => ({}));
                                                        if (!res.ok || !data.success) {
                                                            throw new Error(data?.message || 'Gagal reset ticket');
                                                        }
                                                        // Update the single row locally
                                                        setTickets(prev => prev.map(t => t.id === ticket.id ? { ...t, status: 'valid', checked_in_at: null, scanned_by: null } : t));
                                                        alert('Ticket berhasil direset menjadi VALID.');
                                                    } catch (e) {
                                                        alert(e.message || 'Gagal reset ticket');
                                                    }
                                                }}
                                            >
                                                Reset Ticket
                                            </button>
                                        </td>
                                        <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                                            {ticket.order?.buyer_email || '-'}
                                        </td>
                                        <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                                            #{ticket.order_id}
                                        </td>
                                    </tr>
                                ))}
                            